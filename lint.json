[{"filePath":"D:\\Steller\\stellswap\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Image"},"fix":{"range":[0,32],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Image from \"next/image\";\n\nimport { TopNav } from \"@/components/TopNav\";\nimport { SwapCard } from \"@/components/SwapCard\";\n\nexport default function Home() {\n  return (\n    <div className=\"min-h-screen bg-black text-foreground flex flex-col relative overflow-hidden\">\n      {/* Background ambient light */}\n      <div className=\"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-primary/10 rounded-full blur-[120px] pointer-events-none\" />\n      <div className=\"absolute bottom-[-10%] right-[-10%] w-[30%] h-[30%] bg-blue-500/10 rounded-full blur-[100px] pointer-events-none\" />\n\n      <TopNav />\n      <main className=\"flex-1 flex flex-col items-center justify-center p-4 sm:p-8 relative z-10 min-h-[80vh]\">\n        <div className=\"w-full max-w-lg mb-16\">\n          <SwapCard />\n        </div>\n      </main>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\Steller\\stellswap\\components\\SwapCard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'getExchangeRate'. Either include it or remove the dependency array.","line":78,"column":8,"nodeType":"ArrayExpression","endLine":78,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [getExchangeRate, payAmount, payToken, receiveToken]","fix":{"range":[3194,3229],"text":"[getExchangeRate, payAmount, payToken, receiveToken]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":216,"column":29,"nodeType":"JSXOpeningElement","endLine":216,"endColumn":207},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":278,"column":29,"nodeType":"JSXOpeningElement","endLine":278,"endColumn":215}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1845,1848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1845,1848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5995,5998],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5995,5998],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":159,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6627,6630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6627,6630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":162,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6741,6744],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6741,6744],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":178,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7448,7451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7448,7451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { ArrowDown, Settings, Info, Loader2 } from \"lucide-react\";\r\nimport { useStellarWallet } from \"@/context/StellarWalletProvider\";\r\nimport { TokenSelectorModal } from \"./TokenSelectorModal\";\r\nimport { TOKENS } from \"@/config/tokens\";\r\nimport { toast } from \"sonner\";\r\nimport { Horizon, Contract, nativeToScVal, TransactionBuilder, Networks, rpc } from \"@stellar/stellar-sdk\";\r\n\r\nexport function SwapCard() {\r\n    const { address, signTransaction } = useStellarWallet();\r\n    const [payAmount, setPayAmount] = useState(\"\");\r\n    const [receiveAmount, setReceiveAmount] = useState(\"\");\r\n    const [payToken, setPayToken] = useState(TOKENS[0]);\r\n    const [receiveToken, setReceiveToken] = useState(TOKENS[1]);\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [modalType, setModalType] = useState<\"pay\" | \"receive\">(\"pay\");\r\n\r\n    const [loadingFee, setLoadingFee] = useState(false);\r\n    const [simulatedFeeStroops, setSimulatedFeeStroops] = useState<string | null>(null);\r\n\r\n    const [isPending, setIsPending] = useState(false);\r\n\r\n    const [balances, setBalances] = useState<Record<string, number>>({});\r\n    const [isFetchingBalances, setIsFetchingBalances] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!address) {\r\n            setBalances({});\r\n            return;\r\n        }\r\n        const fetchBalances = async () => {\r\n            setIsFetchingBalances(true);\r\n            try {\r\n                const server = new Horizon.Server(\"https://horizon-testnet.stellar.org\");\r\n                const account = await server.loadAccount(address);\r\n                const newBalances: Record<string, number> = {};\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                account.balances.forEach((b: any) => {\r\n                    if (b.asset_type === 'native') {\r\n                        newBalances['XLM'] = parseFloat(b.balance);\r\n                    } else if (b.asset_code) {\r\n                        newBalances[b.asset_code] = parseFloat(b.balance);\r\n                    }\r\n                });\r\n                setBalances(newBalances);\r\n            } catch (e) {\r\n                console.error(\"Failed to fetch balances\", e);\r\n            } finally {\r\n                setIsFetchingBalances(false);\r\n            }\r\n        };\r\n        fetchBalances();\r\n    }, [address, isPending]);\r\n\r\n    const payBalance = balances[payToken.symbol] || 0;\r\n    const receiveBalance = balances[receiveToken.symbol] || 0;\r\n\r\n    const tokenPrices: Record<string, number> = {\r\n        XLM: 0.12, USDC: 1.0, USDT: 1.0, SOL: 150, EURC: 1.08, ETH: 3500,\r\n    };\r\n\r\n    const getExchangeRate = () => {\r\n        const p1 = tokenPrices[payToken.symbol] || 1;\r\n        const p2 = tokenPrices[receiveToken.symbol] || 1;\r\n        return p1 / p2;\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!payAmount || parseFloat(payAmount) === 0) {\r\n            setReceiveAmount(\"\");\r\n            return;\r\n        }\r\n        const rate = getExchangeRate();\r\n        const amt = parseFloat(payAmount) * rate;\r\n        setReceiveAmount(amt.toFixed(6).replace(/\\.?0+$/, \"\"));\r\n    }, [payAmount, payToken, receiveToken]);\r\n\r\n    useEffect(() => {\r\n        if (!payAmount || parseFloat(payAmount) <= 0) {\r\n            setSimulatedFeeStroops(null);\r\n            return;\r\n        }\r\n\r\n        const simulateGas = async () => {\r\n            setLoadingFee(true);\r\n            await new Promise(r => setTimeout(r, 600));\r\n            setSimulatedFeeStroops(\"457000\");\r\n            setLoadingFee(false);\r\n        };\r\n\r\n        const timer = setTimeout(() => simulateGas(), 500);\r\n        return () => clearTimeout(timer);\r\n    }, [payAmount, payToken, address]);\r\n\r\n    const handleSwap = async () => {\r\n        if (!address) {\r\n            toast.error(\"Please connect your wallet first.\");\r\n            return;\r\n        }\r\n        const payAmtNum = parseFloat(payAmount);\r\n        if (payAmtNum > payBalance) {\r\n            toast.error(`Insufficient ${payToken.symbol} Balance`);\r\n            return;\r\n        }\r\n\r\n        setIsPending(true);\r\n        try {\r\n            toast.loading(\"Simulating transaction...\", { id: \"swap\" });\r\n\r\n            const server = new Horizon.Server(\"https://horizon-testnet.stellar.org\");\r\n            const account = await server.loadAccount(address);\r\n\r\n            const contractId = process.env.NEXT_PUBLIC_CONTRACT_ADDRESS;\r\n            if (!contractId) throw new Error(\"Contract address not configured in .env\");\r\n\r\n            const contract = new Contract(contractId);\r\n            const amountInScale = payToken.symbol === \"XLM\" || payToken.symbol === \"USDC\" || payToken.symbol === \"ETH\" ? 1e7 : 1e7;\r\n            const amountIn = Math.floor(payAmtNum * amountInScale);\r\n            const minOut = Math.floor(parseFloat(receiveAmount) * amountInScale * 0.95); // 5% slippage\r\n\r\n            const operation = contract.call(\"swap\",\r\n                nativeToScVal(address, { type: \"address\" }),\r\n                nativeToScVal(payToken.contractId, { type: \"address\" }),\r\n                nativeToScVal(receiveToken.contractId, { type: \"address\" }),\r\n                nativeToScVal(amountIn, { type: \"i128\" }),\r\n                nativeToScVal(minOut, { type: \"i128\" })\r\n            );\r\n\r\n            const tx = new TransactionBuilder(account, {\r\n                fee: \"100000\",\r\n                networkPassphrase: Networks.TESTNET,\r\n            })\r\n                .addOperation(operation)\r\n                .setTimeout(30)\r\n                .build();\r\n\r\n            const sorobanRpc = new rpc.Server(\"https://soroban-testnet.stellar.org\");\r\n\r\n            // Prepare it for Soroban (simulation + add footprint)\r\n            // Note: casting tx to any or overriding to circumvent types in some older sdk versions\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            const preparedTx = await sorobanRpc.prepareTransaction(tx as any);\r\n            const xdr = preparedTx.toXDR();\r\n\r\n            toast.loading(\"Please sign the transaction in your wallet...\", { id: \"swap\" });\r\n\r\n            const signedXdr = await signTransaction(xdr);\r\n            if (!signedXdr) {\r\n                toast.dismiss(\"swap\");\r\n                return;\r\n            }\r\n\r\n            toast.loading(\"Submitting to network...\", { id: \"swap\" });\r\n\r\n            const submitTx = TransactionBuilder.fromXDR(signedXdr, Networks.TESTNET);\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            const response = await sorobanRpc.sendTransaction(submitTx as any);\r\n\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            if ((response as any).status === \"SUCCESS\") {\r\n                toast.dismiss(\"swap\");\r\n                toast.success(\r\n                    <div className=\"flex flex-col gap-1\">\r\n                        <span>Swap Executed Successfully!</span>\r\n                        <span className=\"text-zinc-500 text-xs\">Testnet tx hash: {response.hash}</span>\r\n                    </div>,\r\n                    { duration: 7000 }\r\n                );\r\n                setPayAmount(\"\");\r\n                setReceiveAmount(\"\");\r\n            } else {\r\n                throw new Error(\"Transaction execution failed on network\");\r\n            }\r\n\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        } catch (e: any) {\r\n            toast.dismiss(\"swap\");\r\n            toast.error(e.message || \"An error occurred during swap execution\");\r\n        } finally {\r\n            setIsPending(false);\r\n        }\r\n    };\r\n\r\n    const isInsufficient = parseFloat(payAmount) > payBalance;\r\n\r\n    return (\r\n        <>\r\n            <div className=\"bg-zinc-950/80 backdrop-blur-3xl border border-zinc-800/50 rounded-3xl p-4 sm:p-6 w-full max-w-[480px] shadow-2xl relative\">\r\n                <div className=\"flex justify-between items-center mb-4 px-2\">\r\n                    <h2 className=\"text-lg font-semibold text-white\">Swap</h2>\r\n                    <button className=\"text-zinc-500 hover:text-white transition\">\r\n                        <Settings className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* You Pay Section */}\r\n                <div className=\"bg-zinc-900/50 rounded-2xl p-4 border border-zinc-800/50 focus-within:border-zinc-700 transition relative\">\r\n                    <label className=\"text-xs text-zinc-400 font-medium mb-2 block\">You Pay</label>\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <input\r\n                            type=\"number\"\r\n                            placeholder=\"0.0\"\r\n                            value={payAmount}\r\n                            onChange={(e) => setPayAmount(e.target.value)}\r\n                            className=\"bg-transparent text-3xl font-medium text-white outline-none w-full mr-4 placeholder-zinc-700\"\r\n                        />\r\n                        <button\r\n                            onClick={() => {\r\n                                setModalType(\"pay\");\r\n                                setIsModalOpen(true);\r\n                            }}\r\n                            className=\"flex items-center gap-2 bg-zinc-800 hover:bg-zinc-700 rounded-full px-3 py-1.5 transition whitespace-nowrap\"\r\n                        >\r\n                            <img src={payToken.icon} alt={payToken.symbol} className=\"w-5 h-5 rounded-full\" onError={(e) => { e.currentTarget.src = \"https://cryptologos.cc/logos/stellar-xlm-logo.png\"; }} />\r\n                            <span className=\"text-white font-medium\">{payToken.symbol}</span>\r\n                            <ArrowDown className=\"w-4 h-4 text-zinc-400\" />\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"text-xs text-zinc-500 mt-3 font-medium\">\r\n                        Balance: {isFetchingBalances ? <Loader2 className=\"w-3 h-3 animate-spin inline ml-1 mr-1\" /> : payBalance.toLocaleString(undefined, { maximumFractionDigits: 6 })} {payToken.symbol}\r\n                        {address && payBalance > 0 && (\r\n                            <button\r\n                                onClick={() => setPayAmount(payBalance.toString())}\r\n                                className=\"ml-2 text-primary/80 hover:text-primary transition uppercase text-[10px] tracking-wider font-bold bg-primary/10 px-2 py-0.5 rounded\"\r\n                            >\r\n                                Max\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Swap Direction Arrow */}\r\n                <div className=\"flex justify-center -my-3 relative z-10\">\r\n                    <button\r\n                        onClick={() => {\r\n                            const temp = payToken;\r\n                            setPayToken(receiveToken);\r\n                            setReceiveToken(temp);\r\n                            setPayAmount(receiveAmount);\r\n                            setReceiveAmount(payAmount);\r\n                        }}\r\n                        className=\"bg-zinc-900 border-4 border-zinc-950 rounded-xl p-2 text-zinc-400 hover:text-white transition group z-20\"\r\n                    >\r\n                        <ArrowDown className=\"w-5 h-5 group-hover:rotate-180 transition-transform duration-300\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* You Receive Section */}\r\n                <div className=\"bg-zinc-900/50 rounded-2xl p-4 border border-zinc-800/50 focus-within:border-zinc-700 transition relative mt-2\">\r\n                    <label className=\"text-xs text-zinc-400 font-medium mb-2 block\">You Receive</label>\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <input\r\n                            type=\"number\"\r\n                            placeholder=\"0.0\"\r\n                            value={receiveAmount}\r\n                            onChange={(e) => {\r\n                                const val = e.target.value;\r\n                                setReceiveAmount(val);\r\n                                if (!val || parseFloat(val) === 0) {\r\n                                    setPayAmount(\"\");\r\n                                    return;\r\n                                }\r\n                                const rate = getExchangeRate();\r\n                                const amt = parseFloat(val) / rate;\r\n                                setPayAmount(amt.toFixed(6).replace(/\\.?0+$/, \"\"));\r\n                            }}\r\n                            className=\"bg-transparent text-3xl font-medium text-white outline-none w-full mr-4 placeholder-zinc-700\"\r\n                        />\r\n                        <button\r\n                            onClick={() => {\r\n                                setModalType(\"receive\");\r\n                                setIsModalOpen(true);\r\n                            }}\r\n                            className=\"flex items-center gap-2 bg-zinc-800 hover:bg-zinc-700 rounded-full px-3 py-1.5 transition whitespace-nowrap\"\r\n                        >\r\n                            <img src={receiveToken.icon} alt={receiveToken.symbol} className=\"w-5 h-5 rounded-full\" onError={(e) => { e.currentTarget.src = \"https://cryptologos.cc/logos/stellar-xlm-logo.png\"; }} />\r\n                            <span className=\"text-white font-medium\">{receiveToken.symbol}</span>\r\n                            <ArrowDown className=\"w-4 h-4 text-zinc-400\" />\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"text-xs text-zinc-500 mt-3 font-medium text-right\">\r\n                        Balance: {isFetchingBalances ? <Loader2 className=\"w-3 h-3 animate-spin inline ml-1 mr-1\" /> : receiveBalance.toLocaleString(undefined, { maximumFractionDigits: 6 })} {receiveToken.symbol}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Exchange Rate Info */}\r\n                {payToken && receiveToken && (\r\n                    <div className=\"flex justify-between items-center text-sm px-2 mt-4 text-zinc-400 font-medium\">\r\n                        <span>Exchange Rate</span>\r\n                        <span className=\"text-white\">\r\n                            1 {payToken.symbol} = {getExchangeRate().toLocaleString(undefined, { maximumFractionDigits: 6 })} {receiveToken.symbol}\r\n                        </span>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Estimated Network Fee Accordion */}\r\n                {parseFloat(payAmount) > 0 && (\r\n                    <div className=\"mt-4 px-2\">\r\n                        <div className=\"flex items-center justify-between text-sm\">\r\n                            <span className=\"text-zinc-400 flex items-center gap-1 cursor-help group relative\">\r\n                                Estimated Network Fee\r\n                                <Info className=\"w-3.5 h-3.5\" />\r\n                                <div className=\"absolute bottom-full mb-2 left-0 w-48 bg-zinc-800 text-xs text-zinc-300 p-2 rounded shadow-xl opacity-0 group-hover:opacity-100 transition pointer-events-none z-50\">\r\n                                    Soroban Multidimensional Fee (Resource + Inclusion)\r\n                                </div>\r\n                            </span>\r\n                            <span className=\"text-zinc-300\">\r\n                                {loadingFee ? (\r\n                                    <Loader2 className=\"w-3 h-3 animate-spin text-zinc-500\" />\r\n                                ) : simulatedFeeStroops ? (\r\n                                    `~ ${(parseInt(simulatedFeeStroops) / 10000000).toFixed(5)} XLM`\r\n                                ) : (\r\n                                    \"--\"\r\n                                )}\r\n                            </span>\r\n                        </div>\r\n                        {simulatedFeeStroops && !loadingFee && (\r\n                            <div className=\"flex items-center justify-between text-xs mt-1 text-zinc-500\">\r\n                                <span>Fee in Stroops</span>\r\n                                <span>{simulatedFeeStroops} strps</span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Action Button */}\r\n                <button\r\n                    disabled={!payAmount || isPending || isInsufficient}\r\n                    onClick={handleSwap}\r\n                    className={`w-full mt-4 py-4 rounded-2xl font-bold text-lg transition-all flex items-center justify-center gap-2 ${isPending\r\n                        ? \"bg-zinc-800 text-zinc-400 cursor-not-allowed\"\r\n                        : isInsufficient\r\n                            ? \"bg-red-500/20 text-red-500 cursor-not-allowed\"\r\n                            : !payAmount\r\n                                ? \"bg-zinc-800 text-zinc-500 cursor-not-allowed\"\r\n                                : \"bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg shadow-primary/20 active:scale-[0.98]\"\r\n                        }`}\r\n                >\r\n                    {isPending ? (\r\n                        <>\r\n                            <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                            Confirming...\r\n                        </>\r\n                    ) : isInsufficient ? (\r\n                        `Insufficient ${payToken.symbol} Balance`\r\n                    ) : !payAmount ? (\r\n                        \"Enter an amount\"\r\n                    ) : (\r\n                        \"Swap\"\r\n                    )}\r\n                </button>\r\n            </div >\r\n\r\n            <TokenSelectorModal\r\n                isOpen={isModalOpen}\r\n                onClose={() => setIsModalOpen(false)}\r\n                selectedTokenSymbol={modalType === \"pay\" ? payToken.symbol : receiveToken.symbol}\r\n                onSelect={(token) => {\r\n                    if (modalType === \"pay\") setPayToken(token);\r\n                    else setReceiveToken(token);\r\n                }}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Steller\\stellswap\\components\\TokenSelectorModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":13,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Image"},"fix":{"range":[210,243],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":88,"column":49,"nodeType":"JSXOpeningElement","endLine":88,"endColumn":227}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Search, X } from \"lucide-react\";\r\nimport { TOKENS, Token } from \"@/config/tokens\";\r\nimport Image from \"next/image\";\r\n\r\ninterface TokenSelectorModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onSelect: (token: Token) => void;\r\n    selectedTokenSymbol?: string;\r\n}\r\n\r\nexport function TokenSelectorModal({ isOpen, onClose, onSelect, selectedTokenSymbol }: TokenSelectorModalProps) {\r\n    const [search, setSearch] = useState(\"\");\r\n\r\n    const filteredTokens = TOKENS.filter(\r\n        (t) =>\r\n            t.symbol.toLowerCase().includes(search.toLowerCase()) ||\r\n            t.name.toLowerCase().includes(search.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <AnimatePresence>\r\n            {isOpen && (\r\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        onClick={onClose}\r\n                        className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n                    />\r\n                    <motion.div\r\n                        initial={{ scale: 0.95, opacity: 0, y: 10 }}\r\n                        animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                        exit={{ scale: 0.95, opacity: 0, y: 10 }}\r\n                        transition={{ type: \"spring\", duration: 0.4 }}\r\n                        className=\"relative w-full max-w-md bg-zinc-950 border border-zinc-800 rounded-2xl shadow-2xl shadow-black/50 overflow-hidden flex flex-col\"\r\n                    >\r\n                        <div className=\"p-4 border-b border-zinc-800 flex justify-between items-center\">\r\n                            <h2 className=\"text-lg font-semibold text-white\">Select a token</h2>\r\n                            <button\r\n                                onClick={onClose}\r\n                                className=\"p-1 rounded-full hover:bg-zinc-800 text-zinc-400 hover:text-white transition\"\r\n                            >\r\n                                <X className=\"w-5 h-5\" />\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"p-4 border-b border-zinc-800\">\r\n                            <div className=\"relative\">\r\n                                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Search name or symbol\"\r\n                                    value={search}\r\n                                    onChange={(e) => setSearch(e.target.value)}\r\n                                    className=\"w-full bg-zinc-900/50 border border-zinc-800 text-white placeholder-zinc-500 rounded-xl py-2.5 pl-10 pr-4 focus:outline-none focus:border-zinc-600 focus:ring-1 focus:ring-zinc-600 transition\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex-1 overflow-y-auto max-h-[400px] p-2 custom-scrollbar\">\r\n                            {filteredTokens.length === 0 ? (\r\n                                <div className=\"py-8 text-center text-zinc-500 text-sm\">\r\n                                    No tokens found.\r\n                                </div>\r\n                            ) : (\r\n                                filteredTokens.map((token) => (\r\n                                    <button\r\n                                        key={token.symbol}\r\n                                        onClick={() => {\r\n                                            onSelect(token);\r\n                                            onClose();\r\n                                            setSearch(\"\");\r\n                                        }}\r\n                                        className={`w-full flex items-center justify-between p-3 rounded-xl transition-all ${selectedTokenSymbol === token.symbol\r\n                                            ? \"bg-white/10 border border-white/20 pointer-events-none opacity-50\"\r\n                                            : \"hover:bg-zinc-800/50 border border-transparent\"\r\n                                            }`}\r\n                                    >\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            {/* Note: since Next.js Image component needs domain configurations, using standard img tag with nice error fallback is safer for third party logos unconfigured */}\r\n                                            <div className=\"w-8 h-8 rounded-full bg-zinc-800 flex items-center justify-center overflow-hidden\">\r\n                                                <img src={token.icon} alt={token.symbol} className=\"w-full h-full object-cover\" onError={(e) => { e.currentTarget.src = \"https://cryptologos.cc/logos/stellar-xlm-logo.png\"; }} />\r\n                                            </div>\r\n                                            <div className=\"text-left\">\r\n                                                <div className=\"text-white font-medium\">{token.symbol}</div>\r\n                                                <div className=\"text-zinc-500 text-xs\">{token.name}</div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </button>\r\n                                ))\r\n                            )}\r\n                        </div>\r\n                    </motion.div>\r\n                </div>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Steller\\stellswap\\context\\StellarWalletProvider.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\Steller\\stellswap\\context\\StellarWalletProvider.tsx:33:9\n  31 |             modules: allowAllModules(),\n  32 |         });\n> 33 |         setKit(kitInstance);\n     |         ^^^^^^ Avoid calling setState() directly within an effect\n  34 |     }, []);\n  35 |\n  36 |     const connect = async () => {","line":33,"column":9,"nodeType":null,"endLine":33,"endColumn":15}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1713,1716],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1713,1716],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":58,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2264,2267],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2264,2267],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2903,2906],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2903,2906],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { createContext, useContext, useEffect, useState, ReactNode } from \"react\";\r\nimport {\r\n    StellarWalletsKit,\r\n    WalletNetwork,\r\n    allowAllModules,\r\n    FREIGHTER_ID,\r\n} from \"@creit.tech/stellar-wallets-kit\";\r\nimport { toast } from \"sonner\";\r\n\r\ninterface StellarWalletContextType {\r\n    address: string | null;\r\n    kit: StellarWalletsKit | null;\r\n    connect: () => Promise<void>;\r\n    disconnect: () => void;\r\n    signTransaction: (xdr: string) => Promise<string | null>;\r\n}\r\n\r\nconst StellarWalletContext = createContext<StellarWalletContextType | undefined>(undefined);\r\n\r\nexport const StellarWalletProvider = ({ children }: { children: ReactNode }) => {\r\n    const [address, setAddress] = useState<string | null>(null);\r\n    const [kit, setKit] = useState<StellarWalletsKit | null>(null);\r\n\r\n    useEffect(() => {\r\n        // Initialize the kit only on the client side to avoid SSR issues\r\n        const kitInstance = new StellarWalletsKit({\r\n            network: WalletNetwork.TESTNET,\r\n            selectedWalletId: FREIGHTER_ID,\r\n            modules: allowAllModules(),\r\n        });\r\n        setKit(kitInstance);\r\n    }, []);\r\n\r\n    const connect = async () => {\r\n        if (!kit) return;\r\n        try {\r\n            await kit.openModal({\r\n                onWalletSelected: async (option) => {\r\n                    try {\r\n                        kit.setWallet(option.id);\r\n                        const { address } = await kit.getAddress();\r\n                        setAddress(address);\r\n                        toast.success(\"Wallet connected!\");\r\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    } catch (e: any) {\r\n                        console.error(e);\r\n                        if (e.message?.includes(\"not detected\") || e.message?.includes(\"extension\")) {\r\n                            toast.error(`${option.name} not detected. Please install the extension.`);\r\n                        } else {\r\n                            toast.error(\"Failed to connect wallet.\");\r\n                        }\r\n                    }\r\n                },\r\n            });\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        } catch (error: any) {\r\n            console.error(error);\r\n        }\r\n    };\r\n\r\n    const disconnect = () => {\r\n        setAddress(null);\r\n        toast.info(\"Wallet disconnected\");\r\n    };\r\n\r\n    const signTransaction = async (xdr: string) => {\r\n        if (!kit || !address) {\r\n            toast.error(\"Wallet not connected\");\r\n            return null;\r\n        }\r\n        try {\r\n            const result = await kit.signTransaction(xdr, {\r\n                networkPassphrase: WalletNetwork.TESTNET,\r\n            });\r\n            return result.signedTxXdr;\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        } catch (e: any) {\r\n            console.error(\"Sign Error:\", e);\r\n            if (e?.message?.toLowerCase().includes(\"reject\") || e?.message?.includes(\"User declined\")) {\r\n                toast.error(\"Transaction rejected by user.\");\r\n            } else {\r\n                toast.error(\"Failed to sign transaction.\");\r\n            }\r\n            return null;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <StellarWalletContext.Provider value={{ address, kit, connect, disconnect, signTransaction }}>\r\n            {children}\r\n        </StellarWalletContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useStellarWallet = () => {\r\n    const context = useContext(StellarWalletContext);\r\n    if (context === undefined) {\r\n        throw new Error(\"useStellarWallet must be used within a StellarWalletProvider\");\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]}]
